<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<style>
    p{
        background-color: bisque;
        max-width: 40vw;
        font-size: 19px;
    }
</style>
<body>
    <p id="title"></p>
    <button onclick="getTitle()">Получить данные</button>
    <hr>
    <div id="body"></div>
</body>
<script>
    const getData = url => {
            return new Promise((resolve, reject) => {
                fetch(url)
                 .then(response => {
                    if(!response.ok){
                        setTimeout(()=>{
                            getData(url)
                        }, 1500)
                    }else{
                        {return response.json()}
                    }
                 })
                 .then(json => resolve(json))
                 .catch(error => reject(error))
            })
        }


    function getTitle() {
        document.getElementById("title").textContent = "Загрузка..."

        // Получение и вывод комментариев от userId 1
        getData('https://jsonplaceholder.typicode.com/posts')
            .then(res => {
                const filteredPosts = res.filter(post => post.userId === 1)
                const onlyValue = filteredPosts.map(post => post.title)
                console.log(onlyValue)
                document.getElementById("title").textContent = onlyValue.join(', ')
                document.getElementById("title").style.padding = 10 + "px"
            })
            .catch(error => console.log(error.message))
    }

    function toDo(){
        getData("https://jsonplaceholder.typicode.com/todos")
        .then(res => {
            const bodyDiv = document.getElementById("body")
            bodyDiv.innerHTML = ""
            res.forEach(todo => {
                const todoDiv = document.createElement("div")
                todoDiv.textContent = `UserId: ${todo.userId}, ID: ${todo.id}, Title: ${todo.title}, Completed: ${todo.completed}`
                todoDiv.style.padding = "10px"
                todoDiv.style.margin = "7px"
                todoDiv.style.borderRadius = "15px"
                todoDiv.style.display = "flex"
                todoDiv.style.justifyContent = "center"
                todoDiv.style.alignItems = "center"
                todoDiv.style.backgroundColor = todo.completed ? "lightgreen" : "lightcoral"
                bodyDiv.appendChild(todoDiv)
            })
        }).catch(e => console.log(e.name))
    }
    toDo()
    
</script>
<style>
#body{
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    width: 90%;
    
    border: solid;
    border-radius: 15px;
}
</style>
</html>
